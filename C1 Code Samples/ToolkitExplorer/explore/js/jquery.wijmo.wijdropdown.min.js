var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijdropdown",i=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype._setOption=function(e,n){var r=this,i=r.options.wijCSS;t.prototype._setOption.call(this,e,n),e==="disabled"&&(r._labelWrap.toggleClass(i.stateDisabled,n),r._label.toggleClass(i.stateDisabled,n),r.element.attr("disabled",n?"disabled":""))},r.prototype._create=function(){var e=this,t=e.element;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n));if(t.get(0).tagName.toLowerCase()!=="select")return;t.is(":visible")?(e._activeItem=null,e._createSelect(),e._bindEvents(),e.needInit=!1):e.needInit=!0,e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.refresh(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijdropdown")},r.prototype._createSelect=function(){this.cssWidth=this.element.get(0).style.width;var e=this,t=e.options,r=e.options.wijCSS,i=e.element,s=i.width(),o=s,u=i.wrap("<div></div>").parent().addClass(r.helperHidden),a=u.wrap("<div></div>").parent().attr("role","select").addClass(r.wijdropdown).addClass(r.widget).addClass(r.stateDefault).addClass(r.cornerAll).addClass(r.helperClearFix),f=n("<label></label>").addClass(r.wijdropdownLabel).addClass(r.cornerAll).attr("id",i.get(0).id+"_select"),l=n("<div></div>").addClass(r.wijdropdownTrigger).addClass(r.stateDefault).addClass(r.cornerRight),c=n('<a href="#"></a>'),h=n("<div>").addClass(r.wijmodropdown),p=n("<ul></ul>").addClass(r.wijdropdownList).addClass(r.content).addClass(r.widget).addClass(r.cornerAll).addClass(r.helperReset).appendTo(h);i.attr("name")&&i.attr("name")!==""&&f.attr("name",i.attr("name")),n("<span></span>").addClass(r.icon).addClass(r.iconArrowDown).appendTo(l),i.get(0).tabIndex!==""&&c.attr("tabindex",i.attr("tabindex")),i.get(0).disabled!==!1&&(e.options.disabled=!0),e.options.disabled&&(c.addClass(r.stateDisabled),f.addClass(r.stateDisabled)),c.append(f),a.append(u).append(c).append(l),t.ensureDropDownOnBody?h.wrap(n("<div></div>").addClass(r.wijdropdown)).parent().appendTo("body").css("position","absolute"):a.append(h),o+=parseInt(f.css("padding-left").replace(/px/,""),10),o+=parseInt(f.css("padding-right").replace(/px/,""),10),o-=16,a.width(o),e._container=a,e._buildList(p,h,o),e._rightTrigger=l,e._label=f,e._listContainer=h,e._list=p,e._value=i.val(),e._selectedIndex=n("option",i).index(i.find("option:selected")),e._selectWrap=u,e._labelWrap=c,a.attr("title",i.attr("title"))},r.prototype._buildList=function(e,t,r){var i=this,s=i.options.wijCSS,o=i.element,u;t.show(),o.children().each(function(t,r){var o=n(r),u,a,f,l=!1;return o.is("option")?e.append(i._buildItem(o)):(u=n("<li></li>").addClass(s.wijdropdownOptgroup),a=n("<span>"+o.attr("label")+"</span>").addClass(s.wijdropdownOptgroupHeader).addClass(s.priorityPrimary),f=n("<ul></ul>").addClass(s.helperReset).addClass(s.wijdropdownItems),o.attr("disabled")=="disabled"&&(l=!0,u.addClass(s.stateDisabled)),o.children("option").each(function(){return l&&n(this).attr("disabled","disabled"),f.append(i._buildItem(n(this))),this}),u.append(a).append(f),e.append(u)),this}),t.height(""),u=t.height(),u=e.outerHeight()<u?e.outerHeight():u,(this.cssWidth===""||this.cssWidth==="auto")&&e.outerWidth()>r-19&&(r=e.outerWidth()+10,this._container.width(r)),t.css({height:u,width:r}),n.browser.msie&&/^[8]\.[0-9]+/.test(n.browser.version)?e.setOutWidth(r-19):e.setOutWidth(r-18),t.data("wijmoWijsuperpanel")?(t.wijsuperpanel("paintPanel"),i.superpanel=t.data("wijmoWijsuperpanel")):i.superpanel=t.wijsuperpanel({unfocus:i.options.unfocus}).data("wijmoWijsuperpanel"),n.fn.bgiframe&&i.superpanel.element.bgiframe(),i.superpanel.vNeedScrollBar||(n.browser.msie&&/^[8]\.[0-9]+/.test(n.browser.version)?e.setOutWidth(r-1):e.setOutWidth(r),i.superpanel.paintPanel(i.options.unfocus)),t.hide()},r.prototype._handelEvents=function(e){var t=this,n=t.options.wijCSS,r="."+t.widgetName,i=t.element;e.bind("click"+r,function(n){if(t.options.disabled)return;t._listContainer.is(":hidden")?t._show():t._hide(),i.click(),e.get(0)===t._label.get(0)?n.preventDefault():t._labelWrap.focus()}).bind("mouseover"+r,function(){if(t.options.disabled)return;t._label.addClass(n.stateHover),t._rightTrigger.addClass(n.stateHover),i.trigger("mouseover")}).bind("mouseout"+r,function(){if(t.options.disabled)return;t._label.removeClass(n.stateHover),t._rightTrigger.removeClass(n.stateHover),i.trigger("mouseout")}).bind("mousedown"+r,function(){if(t.options.disabled)return;t._label.addClass(n.stateActive),t._rightTrigger.addClass(n.stateActive),i.trigger("mousedown")}).bind("mouseup"+r,function(){if(t.options.disabled)return;t._label.removeClass(n.stateActive),t._rightTrigger.removeClass(n.stateActive),i.trigger("mouseup")})},r.prototype._bindEvents=function(){var t=this,r=t.options.wijCSS,i="."+t.widgetName,s=t._label,o=t._rightTrigger,u=t._labelWrap,a=t._listContainer,f=t.element,l=!1,c;t._handelEvents(t._label),t._handelEvents(t._rightTrigger),n(window).bind("resize",function(e){t._setListContainerPosition()}),n(document).bind("mouseup"+i,function(e){if(a.is(":hidden")){s.removeClass(r.stateFocus),o.removeClass(r.stateFocus);return}c=a.offset();if(e.target===s.get(0)||e.target===o.get(0)||e.target===o.children().get(0))return;if(n(e.target).closest(a).length>0)return;if(e.pageX<c.left||e.pageX>c.left+a.width()||e.pageY<c.top||e.pageY>c.top+a.height())s.removeClass(r.stateFocus),o.removeClass(r.stateFocus),t._hide()}),a.bind("click"+i,function(e){var i=n(e.target),s=i.closest("li"),o=s.attr("disabled")&&s.attr("disabled")==="disabled";if(o)return;i.closest("li."+r.wijdropdownItem,n(this).get(0)).length>0&&(t._setValue(),a.css("z-index",""),n.browser.msie&&/^[6,7].[0-9]+/.test(n.browser.version)&&a.parent().css("z-index",""),a.hide(),t._setValueToEle()),f.click()}),u.bind("keydown"+i,function(n){if(t.options.disabled)return;var r=e.getKeyCodeEnum();switch(n.which){case r.UP:case r.LEFT:t._previous(),t._setValue(),t._setValueToEle();break;case r.DOWN:case r.RIGHT:t._next(),t._setValue(),t._setValueToEle();break;case r.PAGE_DOWN:t._nextPage(),t._setValue(),t._setValueToEle();break;case r.PAGE_UP:t._previousPage(),t._setValue(),t._setValueToEle();break;case r.ENTER:case r.NUMPAD_ENTER:t._setValue(),t._listContainer.hide(),t._setValueToEle()}n.which!==r.TAB&&n.preventDefault(),f.trigger("keydown")}).bind("focus"+i,function(){if(t.options.disabled)return;s.addClass(r.stateFocus),o.addClass(r.stateFocus),f.focus()}).bind("blur"+i,function(){if(t.options.disabled)return;s.removeClass(r.stateFocus),o.removeClass(r.stateFocus),f.trigger("blur")}).bind("keypress"+i,function(){if(t.options.disabled)return;f.trigger("keypress")}).bind("keyup"+i,function(){if(t.options.disabled)return;f.trigger("keyup")}),l=/chrome/.test(navigator.userAgent.toLowerCase());if(l||n.browser.safari)u.bind("click"+i,function(){u.focus()}),o.bind("mouseout"+i,function(){if(t.options.disabled)return;s.removeClass(r.stateFocus),o.removeClass(r.stateFocus)})},r.prototype._setListContainerPosition=function(){var e=this,t=e.options,n;if(!t.ensureDropDownOnBody)return;n=e._container.offset(),e._listContainer.parent().offset({left:n.left,top:n.top+e._container.outerHeight()})},r.prototype._init=function(){var e=this;e._initActiveItem(),e._activeItem&&e._label.text(e._activeItem.text())},r.prototype._buildItem=function(e){var t=e.val(),r=e.text(),i=this,s=i.options.wijCSS,o;return r===""&&(r="&nbsp;"),o=n("<li></li>").addClass(s.wijdropdownItem).addClass(s.stateDefault).addClass(s.cornerAll).append(n("<span>"+r+"</span>")).attr("role","option"),e.is(":disabled")?o.attr("disabled","disabled").addClass(s.stateDisabled):o.mousemove(function(e){var t=n(e.target).closest("."+s.wijdropdownItem);t!==this.last&&i._activate(n(this)),this.last=n(e.target).closest("."+s.wijdropdownItem)}),o.data("value",t),o},r.prototype._show=function(){var e=this,t=e._listContainer,r=e.options.showingAnimation;e._setListContainerPosition(),t.css("z-index","100000"),n.browser.msie&&/^[6,7]\.[0-9]+/.test(n.browser.version)&&t.parent().css("z-index","99999"),r?t.show(r.effect,r.options,r.speed,function(){e._initActiveItem()}):t.show()},r.prototype._hide=function(){var e=this,t=e._listContainer,r=e.options.hidingAnimation;if(t.is(":hidden"))return;r?t.hide(r.effect,r.options,r.speed,function(){n.isFunction(r.callback)&&r.callback.apply(e,arguments),n.browser.msie&&/^[6,7]\.[0-9]+/.test(n.browser.version)&&t.parent().css("z-index",""),t.css("z-index","")}):(n.browser.msie&&n.browser.version==="6.0"&&t.parent().css("z-index",""),t.css("z-index",""),t.hide())},r.prototype._setValue=function(){var e=this,t=e.options.wijCSS,r=e._listContainer,i,s;e._activeItem&&(e._label.text(e._activeItem.text()),e._value=e._activeItem.data("value"),e._selectedIndex=n("li."+t.wijdropdownItem,r).index(e._activeItem),e.superpanel.vNeedScrollBar&&(i=e._activeItem.offset().top,s=e._activeItem.outerHeight(),r.offset().top>i?r.wijsuperpanel("scrollTo",0,i-e._list.offset().top):r.offset().top<i+s-r.innerHeight()&&r.wijsuperpanel("scrollTo",0,i+s-r.height()-e._list.offset().top)))},r.prototype._setValueToEle=function(){var e=this,t=e.element,r=t.find(":selected"),i=n("option",t).index(r),s=e._selectedIndex;i!==s&&(n.browser.mozilla&&t.val(e._value),r.removeAttr("selected"),t.find("option:eq("+s+")").prop("selected",!0),t.trigger("change"))},r.prototype._initActiveItem=function(){var e=this,t=e.options.wijCSS;if(e._value!==undefined){if(e._selectedIndex===-1){e._activate(e._list.find("li."+t.wijdropdownItem).eq(0));return}e._list.find("li."+t.wijdropdownItem).each(function(t){if(t===e._selectedIndex)return e._activate(n(this)),!1})}},r.prototype._activate=function(e){var t=this,n=t.options.wijCSS;t._deactivate(),t._activeItem=e,t._activeItem.addClass(n.stateHover).attr("aria-selected",!0)},r.prototype._deactivate=function(){var e=this,t=e.options.wijCSS;e._activeItem&&e._activeItem.removeClass(t.stateHover).attr("aria-selected",!1)},r.prototype._next=function(){this._move("next","first")},r.prototype._previous=function(){this._move("prev","last")},r.prototype._nextPage=function(){this._movePage("first")},r.prototype._previousPage=function(){this._movePage("last")},r.prototype.refresh=function(){var e=this,t=e.options.wijCSS,r=e.element,i;if(e.needInit)e.element.is(":visible")&&(e._activeItem=null,e._createSelect(),e._bindEvents(),e._init(),e.needInit=!1);else{if(!e._list)return;e._listContainer.show(),e._list.empty(),e._buildList(e._list,e._listContainer,i),e._value=e.element.val(),e._selectedIndex=n("option",r).index(r.find("option:selected")),e._initActiveItem(),e._activeItem&&e._label.text(e._activeItem.text())}},r.prototype._move=function(e,t){var n=this,r=n.options.wijCSS,i,s;if(!n._activeItem){n._activate(n._list.find("."+r.wijdropdownItem+":"+t));return}i=n._activeItem[e]().eq(0),i.length?s=n._getNextItem(i,e,t):n._activeItem.closest("."+r.wijdropdownOptgroup).length&&(s=n._getNextItem(n._activeItem.closest("."+r.wijdropdownOptgroup)[e](),e,t));if(!s||!s.length)s=n._getNextItem(n._list.find("."+r.wijdropdownItem+":"+t),e,t);n._activate(s)},r.prototype._movePage=function(e){var t=this,r=t.options.wijCSS,i,s,o,u,a=e==="first"?"next":"prev",f=e==="first"?"last":"first";t.superpanel.vNeedScrollBar?(i=t._activeItem.offset().top,s=t.options.height,o=t._list.find("."+r.wijdropdownItem).filter(function(){var t=n(this).offset().top-i+(e==="first"?-s:s)+n(this).height(),r=n(this).height();return t<r&&t>-r}),o.length||(o=t._list.find("."+r.wijdropdownItem+":"+f))):o=t._list.find("."+r.wijdropdownItem+":"+(t._activeItem?f:e)),u=t._getNextItem(o,a);if(!u||!u.length)u=t._getNextItem(o,a==="next"?"prev":"next");t._activate(u)},r.prototype._getNextItem=function(e,t,n){var r=this.options.wijCSS,i;if(e.length)return e.is("."+r.wijdropdownOptgroup)?e.find(">ul>li."+r.wijdropdownItem).length?i=e.find(">ul>li."+r.wijdropdownItem+":"+n).eq(0):i=this._getNextItem(e[t]().eq(0)):i=e,i.attr("disabled")==="disabled"?i[t]().length?this._getNextItem(i[t](),t):(n||(n=t=="next"?"first":"last"),this._getNextItem(i.closest("."+r.wijdropdownOptgroup)[t](),t,n)):i},r.prototype.destroy=function(){var e=this,n=e.options.wijCSS;this.element.attr("title",this._container.attr("title")),this.element.closest("."+n.wijdropdown).find(">div."+n.wijdropdownTrigger+",>div."+n.wijmodropdown+",>a").remove(),this._listContainer.remove(),this.element.unwrap().unwrap().removeData("maxZIndex"),t.prototype.destroy.call(this)},r}(e.wijmoWidget);t.wijdropdown=i;var s=function(){function e(){this.initSelector=":jqmData(role='wijdropdown')",this.wijCSS={wijmodropdown:"wijmo-dropdown",wijdropdown:"wijmo-wijdropdown",wijdropdownLabel:"wijmo-dropdown-label",wijdropdownTrigger:"wijmo-dropdown-trigger",wijdropdownList:"wijmo-dropdown-list",wijdropdownOptgroup:"wijmo-dropdown-optgroup",wijdropdownOptgroupHeader:"wijmo-optgroup-header",wijdropdownItems:"wijmo-dropdown-items",wijdropdownItem:"wijmo-dropdown-item"},this.zIndex=1e3,this.showingAnimation={effect:"blind"},this.hidingAnimation={effect:"blind"},this.ensureDropDownOnBody=!1}return e}();i.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new s),n.wijmo.registerWidget(r,i.prototype)})(e.dropdown||(e.dropdown={}));var t=e.dropdown})(wijmo||(wijmo={}));